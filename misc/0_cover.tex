%
% NCHU Bachelor Thesis Template
%
% 南昌航空大学毕业设计（论文） —— 使用 XeLaTeX 编译
%
% Copyright 2023 Arnold Chow
%
% The Current Maintainer of this work is Arnold Chow.
%
% Compile with: xelatex -> biber -> xelatex -> xelatex
%
% 封面
%
% 如无特殊需要，本页面无需更改

% Underline new command for student information
% Usage: \dunderline[<offset>]{<line_thickness>}
\newcommand\dunderline[3][-1pt]{{%
  \setbox0=\hbox{#3}
  \ooalign{\copy0\cr\rule[\dimexpr#1-#2\relax]{\wd0}{#2}}}}

% Cover Page
\begin{titlepage}
  \makeatletter
  \@ifundefined{externalMentorName}{
    % 校内毕设封面顶部间距
    \vspace*{-3mm}
  }{
    % 校外毕设封面顶部间距
    \vspace*{-3mm}
  }
  \centering

  \includegraphics[width=11.23cm]{images/header.png}

  \vspace*{26mm}

  \zihao{-0}\textbf{\ziju{0.12}\songti{毕业设计（论文）}}

  \vspace{20mm}

  \hspace{8mm}\zihao{3}\heiti\textbf{题\hspace{10mm}目：}
  \songti\zihao{-3}\selectfont{\dunderline[-10pt]{1pt}{\makebox[78mm][c]{\thesisTitle}}}

  \vspace{3mm}

  % \begin{spacing}{1.2}
  %   \zihao{3}\selectfont{\textbf{\thesisTitleEN}}
  % \end{spacing}

  \vspace{15mm}

  \flushleft

  \makeatletter
  \@ifundefined{externalMentorName}{
    % 生成校内毕设封面字段
    \makeatother
    \begin{spacing}{1.8}
      \hspace{27mm}\zihao{3}\heiti{学\hspace{11mm}院：}
      \zihao{-3}\songti\selectfont{\dunderline[-10pt]{1pt}{\makebox[78mm][c]{\deptName}}}

      \hspace{27mm}\zihao{3}\heiti{专业名称：}
      \songti\zihao{3}\selectfont{\dunderline[-10pt]{1pt}{\makebox[78mm][c]{\majorName}}}

      \hspace{27mm}\zihao{3}\heiti{班级学号：}
      \songti\zihao{-3}\selectfont{\dunderline[-10pt]{1pt}{\makebox[78mm][c]{\yourStudentID}}}

      \hspace{27mm}\zihao{3}\heiti{学生姓名：}
      \songti\zihao{-3}\selectfont{\dunderline[-10pt]{1pt}{\makebox[78mm][c]{\yourName}}}

      \hspace{27mm}\zihao{3}\heiti{指导教师：}
      \songti\zihao{-3}\selectfont{\dunderline[-10pt]{1pt}{\makebox[78mm][c]{\mentorName}}}
    \end{spacing}
  }{
    % 生成校外毕设封面字段
    \makeatother
    \begin{spacing}{1.8}
      \hspace{19.4mm}\songti\zihao{3}\selectfont{学\hspace{19.6mm}院\hspace{3mm}：\dunderline[-10pt]{1pt}{\makebox[77.4mm][c]{\deptName}}}

      \hspace{19.4mm}\songti\zihao{3}\selectfont{专\hspace{2.8mm}业\hspace{2.8mm}名\hspace{2.8mm}称\hspace{3mm}：\dunderline[-10pt]{1pt}{\makebox[77.4mm][c]{\majorName}}}

      \hspace{19.4mm}\songti\zihao{3}\selectfont{班\hspace{2.8mm}级\hspace{2.8mm}学\hspace{2.8mm}号\hspace{3mm}：\dunderline[-10pt]{1pt}{\makebox[77.4mm][c]{\yourStudentID}}}

      \hspace{19.4mm}\songti\zihao{3}\selectfont{学\hspace{2.8mm}生\hspace{2.8mm}姓\hspace{2.8mm}名\hspace{3mm}：\dunderline[-10pt]{1pt}{\makebox[77.4mm][c]{\yourName}}}

      \hspace{19.4mm}\songti\zihao{3}\selectfont{指\hspace{2.8mm}导\hspace{2.8mm}教\hspace{2.8mm}师\hspace{3mm}：\dunderline[-10pt]{1pt}{\makebox[77.4mm][c]{\mentorName}}}

      \hspace{19.4mm}\songti\zihao{3}\selectfont{校外指导教师：\dunderline[-10pt]{1pt}{\makebox[77.4mm][c]{\externalMentorName}}}
    \end{spacing}
  }

  \vspace{25mm}
  \centering
  \zihao{3}\ziju{0.5}\songti{\today}
\end{titlepage}
